<!DOCTYPE html>
<!--
    FoodShaker :: Cross-Platform Random Food Generator
    A Harvard University's CS50 Final Project
    by GÃ¡bor Hargitai
-->
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <link rel="stylesheet" href="css/onsenui.css">
        <link rel="stylesheet" href="css/onsen-css-components.css">
        <title>FoodShaker</title>
    </head>
    <body>
        <ons-navigator title="Navigator" var="myNavigator">
            <ons-page>        
                <div class="backdrop">
        
                    <div class="shake-icon"></div>

                    <div class="shake-text">
                        Shake Me!
                    </div>

                    <div style="text-align: center">
                      <br>
                      <ons-button class="button-fridge" modifier="light" onclick="myNavigator.pushPage('page1.html', { animation : 'slide' } )">
                        What's in my fridge?
                      </ons-button>
                    </div>
                </div>
          </ons-page>
        </ons-navigator>

        <ons-template id="page1.html">
          <ons-page>
            <ons-toolbar>
              <div class="left">
                <ons-back-button>Back</ons-back-button>
              </div>
              <div class="center">Page 2</div>
            </ons-toolbar>

            <div style="text-align: center">
              <br />
              <ons-button modifier="light" onclick="myNavigator.popPage()">
                Go Back!
              </ons-button>
                
            </div>
          </ons-page>
        </ons-template>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/angular/angular.js"></script>
        <script type="text/javascript" src="js/onsenui.js"></script>
        <script type="text/javascript" src="js/shake.js"></script>
        <script >
            // initialize the platform
            //app.initialize();
            ons.bootstrap();

            //create a new instance of shake.js.
            var myShakeEvent = new Shake({
                threshold: 15
            });
            
            // start listening to device motion
            myShakeEvent.start();
            
            // register a shake event
            window.addEventListener('shake', shakeEventDidOccur, false);
            
            //shake event callback
            function shakeEventDidOccur() {
                //put your own code here etc.
                console.log("Shake event!");
                
                var fullPath = getPhoneGapPath() + 'shaker.mp3';
                
                if (device.platform == 'Android') {
                    fullPath = '/android_asset/www/' + 'shaker.mp3';
                }
                
                console.log('Full path to audio: '+fullPath);
                
                var myMedia = new Media(fullPath,
                    // success callback
                    function () {
                        console.log("playAudio():Audio Success");
                    },
                    // error callback
                    function (err) {
                        console.log("playAudio():Audio Error: " + err);
                    }
                );
                myMedia.setVolume('1.0');
                myMedia.play();
            }

            function mediaError(e) {
                alert(JSON.stringify(e));
            }
            
            function getPhoneGapPath() {
                var path = window.location.pathname;
                path = path.substr( path, path.length - 10 );
                //return 'cdvfile://' + path;
                return path;

            };

        </script>
    </body>
</html>
