<!DOCTYPE html>
<!--
    FoodShaker :: Cross-Platform Random Food Generator
    A Harvard University's CS50 Final Project
    by GÃ¡bor Hargitai
-->
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <link rel="stylesheet" href="css/onsenui.css">
        <link rel="stylesheet" href="css/onsen-css-components.css">
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/angular/angular.js"></script>
        <script type="text/javascript" src="js/onsenui.js"></script>
        <script type="text/javascript" src="js/shake.js"></script>
        <script >
            // initialize the platform
            //app.initialize();
            ons.bootstrap()
            
            .controller('modalController', function($scope) {
                $scope.dismiss = function() {
                    modal.hide();
                }
            })
            
            .controller('MyController', function($scope, $timeout) {
                $scope.items = [{}, {}, {}, {}];
                
                if (audioEnabled) {
                    $scope.audToggle = true;
                }
                
                $scope.check = function(){
                    if ($scope.audToggle) {
                        console.log("ENABLED!");
                        audioEnabled = true;
                    } else {
                        console.log("DISABLED!");
                        audioEnabled = false;
                    }
                }
            });
            
            ons.ready(function(){ 
             tabbar.on('postchange', function(event) {

                // Only with the tab we want, we can use the index or the name
                if (event.index === 1) {

                    console.log("fridge opened");

                    // Delete this listener so it's only triggered the first time
                    //myTabbar.off('postchange');
                }
                else if (event.index === 2) {
                     
                    console.log('settings opened');

                }

                });
            });
            
        </script>
        <!-- // the script that handles the shake-motion detection !-->
        <script type="text/javascript" src="js/shake-alert.js"></script>
        <title>FoodShaker</title>
    </head>
    <body> 
        <ons-tabbar var="tabbar">
            <ons-tabbar-item
                icon="ion-refresh"
                label="Shake!"
                page="shake"
                active="true"></ons-tabbar-item>
            <ons-tabbar-item
                icon="ion-nuclear"
                label="Fridge"
                page="fridge"></ons-tabbar-item>
            <ons-tabbar-item
                icon="gear"
                label="Settings"
                page="settings"></ons-tabbar-item>
        </ons-tabbar>

        <ons-template id="shake">
            <ons-page id="shake-page">
                <div class="backdrop">
                    <div class="shake-icon"></div>
                    <div class="shake-text">Shake Me!</div>
                </div>
            </ons-page>
        </ons-template>
        
        <ons-modal var="modal" ng-controller="modalController">
            <ons-icon icon="ion-load-c" spin="true"></ons-icon>
            <br>
            <br> This is your recipe.
            <br>
            <br> Well, just a placeholder.
            <br>
            <br>Closing in 4 seconds.
            <br>
            <br>
            <ons-button ng-click="dismiss()">Close Manually</ons-button>
        </ons-modal>
        
        <ons-template id="fridge">
            <ons-page id="fridge-page">
                <ons-toolbar>
                    <div class="center">Fridge</div>
                </ons-toolbar>    
                    <script type="text/javascript">console.log('Fridge chosen!');</script>
                    <div class="shake-text">FRIDGE!</div>
                
            </ons-page>
        </ons-template>
        

        <ons-template id="settings">
            <ons-page ng-controller="MyController">   
                <ons-toolbar>
                    <div class="center">Settings</div>
                </ons-toolbar>

                <br/>
                <br/>
                <div class="settings-header">Audio</div>
                <ons-list modifier="inset" class="settings-list">
                    <ons-list-item>
                        Enable Shaker Sound
                      <ons-switch modifier="list-item" var='audioSwitch' ng-model='audToggle' ng-change='check()'></ons-switch>
                    </ons-list-item>
                </ons-list>
            </ons-page>
        </ons-template>
        
        

    </body>
</html>
